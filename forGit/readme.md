# Документация коду

## Класс `RThread`

### Описание

Расширение стандартного потока (`Thread`) для выполнения задач и хранения результатов выполнения.

### Атрибуты

- `target`: Целевая функция, которая будет выполнена в потоке.
- `result`: Хранит результат выполнения целевой функции.

### Методы

#### `run()`

Запускает выполнение целевой функции и сохраняет результат в атрибуте `result`.

---

## Класс `Grade`

### Описание

Класс для представления данных о классе, включая информацию о предметах и четверти.

### Аргументы конструктора

- `subjects (dict[str, DataFrame])`: Словарь, где ключ — название предмета, значение — таблица оценок.
- `grade (str)`: Название класса (например, "4А").
- `quarter (int)`: Номер четверти.

### Методы

#### `to_excel(path: str = "./data")`

Сохраняет данные о классе и предметах в Excel-файл.

- **Аргументы**:

  - `path (str)`: Путь для сохранения файла (по умолчанию `"./data"`).

- **Пример**: Файл будет сохранен с именем `"<grade>-<quarter>.xlsx"`.

#### `print_subjects()`

Выводит список предметов и таблицы оценок для каждого предмета в формате Pandas DataFrame.

---

## Класс `KParser`

### Описание

Класс для работы с системой Kundoluk. Основная цель — получение данных о классах, предметах и обработка пользовательского ввода.

### Атрибуты

- `__headers`: Словарь заголовков для HTTP-запросов.
- `url (str)`: Базовый URL для запросов.
- `s (requests.Session)`: HTTP-сессия для повторного использования соединений.
- `grades (list[tuple[str, int]])`: Список доступных классов и их идентификаторов.

### Методы

#### `get_grade(grade: tuple[str, int], quarter: int = 1) -> Grade`

Получает данные о классе и четверти.

- **Аргументы**:

  - `grade (tuple[str, int])`: Кортеж с названием класса и его идентификатором.
  - `quarter (int)`: Номер четверти (по умолчанию `1`).

- **Возвращает**:

  - `Grade`: Объект с данными о предмете.

- **Пример использования**:

  ```python
  parser = KParser()
  grade = parser.get_grade(("4А", 90343), quarter=1)
  grade.to_excel()
  ```

#### `get_subject(url: str) -> DataFrame`

Получает данные о предмете по указанной ссылке.

- **Аргументы**:

  - `url (str)`: URL-адрес страницы с информацией о предмете.

- **Возвращает**:

  - `DataFrame`: Таблица с данными об оценках.

#### `magic() -> Grade`

Обрабатывает пользовательский ввод для получения данных о классе и четверти. Предоставляет интерфейс взаимодействия через консоль.

- **Возвращает**:

  - `Grade`: Объект класса Grade после успешной обработки.

- **Особенности**:

  - Поддержка выхода из программы при нажатии `Ctrl+C`.
  - Проверка корректности пользовательского ввода.

---

## Основные сценарии использования

### 1. Получение данных о классе и сохранение в Excel

```python
parser = KParser()
grade = parser.get_grade(("4А", 90343), quarter=2)
grade.to_excel("./output")
```

### 2. Вывод информации о предметах в консоль

```python
grade.print_subjects()
```

### 3. Интерактивная обработка пользовательского ввода

```python
parser = KParser()
parser.magic()
```

---

## Зависимости

- `os`: Работа с переменными окружения.
- `time`: Реализация задержек и управления потоками.
- `StringIO`: Обработка данных в памяти как файловый объект.
- `Threading`: Многопоточность.
- `pandas`: Работа с табличными данными.
- `requests`: Выполнение HTTP-запросов.
- `BeautifulSoup`: Разбор HTML-документов.
